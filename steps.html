<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <title>My Flask App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playpen+Sans+Arabic:wght@100..800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container header my-4 p-3 border rounded-4">
        <h1 class="text-center fw-bold appInfo" style="font-weight:800; text-align: center;">ุณุณุชู ุชุตูู ฺฏุฑ ุชุงูู ูุงู</h1>
        <p class="more" style="text-align: center;">ุงุทูุงุนุงุช ููุฑุฏ ูุงุฒ ุฏุฑ ูุฑ ูุฑุญูู ุฑุง ุจู ุฏูุช ูุงุฑุฏ ฺฉูุฏ ุชุง ุชุญูู ู ุชุตูู ฺฏุฑ ุจู ุฏุฑุณุช ุงูุฌุงู ุดูุฏ.</p>
    </div>

    <!-- steps -->
    <div class="container steps text-center p-3 border rounded-4">
        <ul class="step list-inline">
            <li class="list-inline-item">
                <div class="stepIcon {% if step == 1 %}active{% endif %}">ุงูพูฺฉุดู</div>
            </li>
            <li class="list-inline-item">
                <div class="stepIcon {% if step == 2 %}active{% endif %}">ุงุทูุงุนุงุช</div>
            </li>
            <li class="list-inline-item">
                <div class="stepIcon {% if step == 3 %}active{% endif %}">ุฑูุด</div>
            </li>
            <li class="list-inline-item">
                <div class="stepIcon {% if step == 4 %}active{% endif %}">ูุชุฌู</div>
            </li>
        </ul>
    </div>

    {% if step == 1 %}
    <form action="{{ url_for('step_one') }}" method="POST" class="container step_one border rounded-4 p-3 mt-4">
        <h2>ูุฑุญูู ุงูู: ุฏุฑุจุงุฑู ุงูพูฺฉุดู</h2>
        <div class="manInfo" style="border: 1px solid rgb(191 219 254); background-color: rgb(239 246 255); border-radius: 10px; padding: 10px;">
            <h6 class="about">
                ุงุทูุงุนุงุช ุชููุฏ ฺฉููุฏู
            </h6>
            <label>ูุงู ุดุฑฺฉุช:
                <input name="company_name" type="text" class="form-control" required>
            </label>
            <ul class="loanType" style="margin-top: 15px;">
                <li><span style="font-weight: 600;">ูุงู ูพุด ูพุฑุฏุงุฎุช(Prepayment Loan)'L':</span> ุจุฑุง ุฎุฑุฏ ููุฌูุฏ ุจุฑุง ูุฑูุด ุขููุงู </li>
                <li><span style="font-weight: 600;">ูุงู ุฏุฑุงูุชู(Receivables Loan)'A': </span>ุจุฑุง ุชุฃูู ูุงู ุนููุงุช ุจุงุฒุงูุช</li>
            </ul>
        </div>
        <ul class="forandrev" style="list-style: none; padding: 0;">
            <li style="display: inline-block;width: 49%;">
                <div class="forSup" style="border: 1px solid rgb(187 247 208); background-color: rgb(240 253 244); border-radius: 10px; padding: 10px; margin: 20px 0;">
                    <h6 class="about">
                        ุฒูุฌุฑู ุชุงูู ุฑู ุจู ุฌูู
                    </h6>
                    <span>
                        ุชุฃูู ูุงู ุจุฑุง ุฎุฑุฏ ฺฉุงูุง ุงุฒ ุชููุฏฺฉููุฏู ู ูุฑูุด ุงุฒ ุทุฑู ฺฉุงูุงู ุขููุงู
                    </span>
                </div>
            </li>
            <li style="display: inline-block; width: 50%;">
                <div class="forSup" style="width: 100%; border: 1px solid rgb(233 213 255); background-color: rgb(250 245 255); border-radius: 10px; padding: 10px; margin: 20px 0;">
                    <h6 class="about">
                        ุฒูุฌุฑู ุชุงูู ูุนฺฉูุณ
                    </h6>
                    <span>
                        ุชุฃูู ูุงู ุจุฑุง ุนููุงุช ุจุงุฒุงูุช ู ูุนุงูุชโูุง ุงูุชุตุงุฏ ฺุฑุฎุด
                    </span>
                </div>
            </li>
        </ul>
        <button type="submit" class="btn btn-primary w-100 mt-3">ูุฑุญูู ุจุนุฏ</button>
    </form>
    {% endif %}

    {% if step == 2 %}
    <form action="{{ url_for('step_two') }}" method="POST" class="container step_two border rounded-4 p-3 mt-4">
        <h2 class="stepInfo">ูุฑุญูู ุฏูู: ูุงุฑุฏ ฺฉุฑุฏู ุงุทูุงุนุงุช</h2>

        <!-- ุฒูุฌุฑู ุฑู ุจู ุฌูู -->
        <div class="forward w-50 mt-3" style="display: inline-block; width: 49% !important;">
            <h6 class="about">ุฒูุฌุฑู ุชุงูู ุฑู ุจู ุฌูู</h6>
            <label style="display: block; margin: 20px 0;">ููุช ูุฑูุด ุนูุฏู (w)
                <input name="w" id="w" type="number" step="any" class="form-control" required>
            </label>
            <label style="display: block; margin: 20px 0;">ุชุนุฏุงุฏ ูุฑูุด ุขููุงู (Q_r)
                <input name="Qr" id="Qr" type="number" step="any" class="form-control" required>
            </label>
        </div>

        <!-- ุฒูุฌุฑู ูุนฺฉูุณ -->
        <div class="inverse w-50 mt-3" style="display: inline-block; width: 49% !important;">
            <h6 class="about">ุฒูุฌุฑู ุชุงูู ูุนฺฉูุณ</h6>
            <label style="display: block; margin: 20px 0;">ููุช ุงูุชูุงู ุจุงุฒุงูุช (R_p)
                <input name="Rp" id="Rp" type="number" step="any" class="form-control" required>
            </label>
            <label style="display: block; margin: 20px 0;">ุชุนุฏุงุฏ ูุญุตููุงุช ุจุงุฒุงูุช
                <input name="recycled" id="recycled" type="number" step="any" class="form-control" required>
            </label>
        </div>

        <!-- ูพุงุฏุงุฑ -->
        <div class="sustain w-100 mt-3" style="display: block;">
            <h6 class="about">ุงูุชุงุฒ ูพุงุฏุงุฑ(e)</h6>
            <label style="display: block; margin: 20px 0;">ุงุฒ 1 ุชุง 10 ุงูุชุงุฒ ุฏูุฏ
                <input name="sustain" id="sustain" type="number" step="any" class="form-control" required>
            </label>
        </div>


        <!-- ูุชุงุฌ -->
        <div class="Prepayment w-50 mt-3" style="display: inline-block; width: 49% !important;">
            <h6 class="about">ูุงู ูพุด ูพุฑุฏุงุฎุช</h6>
            <p class="amount" id="prepaymentAmount" style="font-weight:bold; font-size:18px; color:blue;">
                {% if prepayment is defined and prepayment %}
                    {{ prepayment }}
                {% else %}
                    0
                {% endif %}
                $
            </p>
        </div>

        <div class="Receivables w-50 mt-3" style="display: inline-block; width: 49% !important;">
            <h6 class="about">ูุงู ุฏุฑุงูุชู</h6>
            <p class="amount" id="receivablesAmount" style="font-weight:bold; font-size:18px; color:blue;">
                {% if receivables is defined and receivables %}
                    {{ receivables }}
                {% else %}
                    0
                {% endif %}
                $
            </p>
        </div>

        <div class="d-flex justify-content-between mt-4">
        <a href="{{ url_for('step_one') }}" class="btn btn-secondary w-25">โ ูุฑุญูู ูุจู</a>
        <button type="submit" class="btn btn-primary w-25">ูุฑุญูู ุจุนุฏ โ</button>
    </div>
    </form>

    <!-- ๐น ุงุณฺฉุฑูพุช ุจุฑุง ูุญุงุณุจู ุฒูุฏู -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const wInput = document.getElementById("w");
        const QrInput = document.getElementById("Qr");
        const prepaymentDisplay = document.getElementById("prepaymentAmount");

        function updatePrepayment() {
            const w = parseFloat(wInput.value) || 0;
            const Qr = parseFloat(QrInput.value) || 0;
            const prepayment = w * Qr;
            prepaymentDisplay.textContent = prepayment.toLocaleString('fa-IR');
        }

        wInput.addEventListener("input", updatePrepayment);
        QrInput.addEventListener("input", updatePrepayment);
    });

    document.addEventListener("DOMContentLoaded", function() {
        const RpInput = document.getElementById("Rp");
        const recycledInput = document.getElementById("recycled");
        const receivablesDisplay = document.getElementById("receivablesAmount");

        function updateReceivables() {
            const Rp = parseFloat(RpInput.value) || 0;
            const recycled = parseFloat(recycledInput.value) || 0;
            const receivables = Rp * recycled;
            receivablesDisplay.textContent = receivables.toLocaleString('fa-IR');
        }

        RpInput.addEventListener("input", updateReceivables);
        recycledInput.addEventListener("input", updateReceivables);
    });
    </script>
    {% endif %}

    {% if step == 3 %}
    <form action="{{ url_for('step_three') }}" method="POST" class="container step_three border rounded-4 p-3 mt-4">
        <h4>ูุฑุญูู ุณูู: ุงูุชุฎุงุจ ุฑูุด</h4>

        <div class="method d-flex justify-content-between mt-3">
            <!-- ๐น ุฑูุด ุณูุช -->
            <label class="tradition border rounded-3 p-3 w-50 me-2" style="cursor:pointer;">
                <input type="radio" name="method_choice" value="traditional" required style="margin-left:10px;">
                <h6>ุฑูุด ุณูุช</h6>
                <ul class="trad">
                    <li>ูุฒูู ุงุฑุฒุงุจ: <span>$10.000</span></li>
                    <li>ูุฑุฎ ุชุงุฏ (ฮฑ_t): <span>55%</span></li>
                    <li>ูุฑุฎ ุจูุฑู (i_t): <span>15%</span></li>
                    <li>ุฒูุงู ูพุฑุฏุงุฒุด: <span>ุฑูุฒ 18</span></li>
                </ul>
                <p class="info">
                    <strong>ูุฑุงูุฏ ุฏุณุช:</strong>
                    ุงุณูุงุฏ ฺฉุงุบุฐุ ูุฒููโูุง ุจุงูุงุ ุฏุฏ ูุญุฏูุฏ
                </p>
            </label>

            <!-- ๐น ุฑูุด ุจูุงฺฉฺู -->
            <label class="blockchain border rounded-3 p-3 w-50 ms-2" style="cursor:pointer;">
                <input type="radio" name="method_choice" value="blockchain" required style="margin-left:10px;">
                <h6>ุฑูุด ูุจุชู ุจุฑ ุจูุงฺฉฺู</h6>
                <ul class="trad">
                    <li>ูุฒูู ุงุฑุฒุงุจ: <span>$15.000</span></li>
                    <li>ูุฑุฎ ุชุงุฏ (ฮฑ_t): <span>88%</span></li>
                    <li>ูุฑุฎ ุจูุฑู (i_t): <span>10%</span></li>
                    <li>ุฒูุงู ูพุฑุฏุงุฒุด: <span>ุฑูุฒ 3</span></li>
                </ul>
                <p class="info">
                    <strong>ูุฑุงูุฏ ุงุชููุงุชฺฉ:</strong>
                    ุฏุงุฏูโูุง ุดูุงูุ ูพุงุฏุงุฑ ุชุฃุฏ ุดุฏูุ ูุธุงุฑุช ุฏุฑ ูุญุธู
                </p>
            </label>
        </div>

        <div class="why-block">
            <p>
                ฺุฑุง ุจูุงฺฉฺู ุจูุชุฑ ุงุณุชุ
            </p>
            <ul class="reason">
                <li>ุณูุงุจู ุชุฑุงฺฉูุดโูุง ุชุบุฑูุงูพุฐุฑุ ุงุนุชูุงุฏ ุฑุง ุงูุฒุงุด ูโุฏููุฏ</li>
                <li>ูุดุงูุฏูโูพุฐุฑ ุฒูุฌุฑู ุชุฃูู ุฏุฑ ูุญุธูุ ุฑุณฺฉ ุฑุง ฺฉุงูุด ูโุฏูุฏ</li>
                <li>ูุนุงุฑูุง ูพุงุฏุงุฑ ุชุฃุฏ ุดุฏู ุงุฑุฒุด ุจุงุฒุงุฑ ุฑุง ุงูุฒุงุด ูโุฏููุฏ</li>
                <li>ูุฑุงุฑุฏุงุฏูุง ููุดููุฏุ ุงูุทุจุงู ู ูพุฑุฏุงุฎุชโูุง ุฑุง ุฎูุฏฺฉุงุฑ ูโฺฉููุฏ</li>
                <li>ุฑุณฺฉ ฺฉูุชุฑ = ูุฑุฎ ุจูุฑู ฺฉูุชุฑ ุจุฑุง ูุงู ฺฏุฑูุฏฺฏุงู</li>
            </ul>
        </div>

        <div class="d-flex justify-content-between mt-4">
        <a href="{{ url_for('step_two') }}" class="btn btn-secondary w-25">โ ูุฑุญูู ูุจู</a>
        <button type="submit" class="btn btn-primary w-25">ูุฑุญูู ุจุนุฏ โ</button>
    </div>
    </form>

    <!-- ๐ธ ฺฉู ุงุณุชุงู ุจุฑุง ุงูุชุฎุงุจ -->
    <style>
    .method label:hover {
        background-color: #eef6ff;
    }
    input[type="radio"]:checked + h6,
    input[type="radio"]:checked ~ .info {
        color: #0d6efd;
        font-weight: bold;
    }
    input[type="radio"] {
        display: none;
    }
    .method label:visited{
        background-color: orange;
    }
    </style>
    {% endif %}


    {% if step == 4 %}
    <div class="container step_four border rounded-4 p-3 mt-4">
    <div class="calculate">
        <h5>ูุชุงุฌ ูุญุงุณุจู ูุงู</h5>

        <div class="pre" style="display: inline-block;">
            ูุงู ูพุด ูพุฑุฏุงุฎุช (L):
            <span class="result-pre" style="font-weight:bold; color:blue;">
                {{ prepayment | int | tojson }}
            $</span>
        </div>

        <div class="rec" style="display: inline-block; margin-right:30px;">
            ูุงู ุฏุฑุงูุชู (A):
            <span class="result-rec" style="font-weight:bold; color:blue;">
                {{ receivables | int | tojson }}
            $</span>
        </div>

        <div class="total" style="display: inline-block; margin-right:30px;">
            ูุจูุบ ฺฉู ุชุงูู ูุงู:
            <span class="result-total" style="font-weight:bold; color:green;">
                {{ total | int | tojson }}
            $</span>
        </div>
    </div>

    <div class="compare">
        <h5>
            ููุงุณู ุฑูุดูุง : ุณูุช ู ุจูุงฺฉฺู
        </h5>
        <table>
            <tr>
                <th>
                    ูุนุงุฑ
                </th>
                <th>ุณูุช</th>
                <th>ุจูุงฺฉฺู</th>
            </tr>
            <tr>
                <th>ุงูุชุงุฒ ุงุนุชุจุงุฑ</th>
                <td>580</td>
                <td>820</td>
            </tr>
            <tr>
                <th>ุงุญุชูุงู ุชุตูุจ (ฮฑ)</th>
                <td>55%</td>
                <td>88%</td>
            </tr>
            <tr>
                <th>ูุฑุฎ ุจูุฑู (i)	</th>
                <td>15%</td>
                <td>8%</td>
            </tr>
            <tr>
                <th>ุฒูุงู ูพุฑุฏุงุฒุด</th>
                <td>18 ุฑูุฒ</td>
                <td>3 ุฑูุฒ</td>
            </tr>
            <tr>
                <th>ูุฒูู ุงุฑุฒุงุจ</th>
                <td>10.000$</td>
                <td>1.500$</td>
            </tr>
            <tr style="background-color: #0d6dfd50;">
                <th>ุณูุฏ ุจุงูฺฉ (ฯ_B)</th>
                <td class="pbank_trad">
                    {{ "%.2f"|format(pbank_trad) }} $
                </td>
                <td class="pbank_block">
                    {{ "%.2f"|format(pbank_block) }} $
                </td>
            </tr>

        </table>

    
        {% if loan_status == 'approve' %}
    <div class="loan_dis one_loan">
        <h5>ุชุตูู ฺฏุฑ ููุง ูุงู</h5>
            <div class="approve">
                ูุงู ููุฑุฏ ุชุงุฏ ุงุณุช.
                <div class="app_amount">ูุจูุบ ูุงู: {{ total | int }} $</div>
                <div class="interest">ูุฑุฎ ุจูุฑู: 15%</div>
                <div class="monthly">ูุณุท ูุงูุงูู: {{ (total*0.15/12) | round(2) }} $</div>
            </div>
    </div>
    
        {% elif loan_status == 'half_approve' %}
    <div class="loan_dis half_loan">
        <h5>ุชุตูู ฺฏุฑ ููุง ูุงู</h5>
            <div class="half_approve">
                ูุงู ุฏุฑ ุฏุณุช ุจุฑุฑุณ ุงุณุช.
                <ul class="half">
                    <li>ุงูุชุธุงุฑ ูโุฑูุฏ ุธุฑู ฑธ ุฑูุฒ ฺฉุงุฑ ุชุตูู ฺฏุฑูุชู ุดูุฏ</li>
                    <li>ุงุญุชูุงู ุชุฃุฏ: ตต.ฐูช</li>
                    <li>ุฏุฑ ุตูุฑุช ุชุฃุฏุ ูุฑุฎ ุจูุฑู: ฑต.ตูช</li>
                </ul>
                <span><strong>ุชูุตู: </strong>ุจุฑุง ุชุฃุฏ ุณุฑุนโุชุฑุ ูุฑุฎโูุง ูพุงูโุชุฑ ู ุดุฑุงุท ุจูุชุฑุ ุจู ุงุฑุฒุงุจ ูุจุชู ุจุฑ ุจูุงฺฉฺู ุฑู ุจุงูุฑุฏ.</span>
            </div>
    </div>
    
        {% else %}
    <div class="loan_dis no_loan">
        <h5>ุชุตูู ฺฏุฑ ููุง ูุงู</h5>
            <div class="not_approved">
                ูุงู ุดูุง ุชุงุฏ ูุดุฏ.
            </div>
        {% endif %}
    </div>

    <div class="d-flex justify-content-between mt-4">
        <a href="{{ url_for('step_three') }}" class="btn btn-secondary w-25">โ ูุฑุญูู ูุจู</a>
        <button onclick="window.print()" class="btn btn-success w-25">๐ ูพุงุงู ู ฺุงูพ ูุชุฌู</button>
    </div>

    </div>

    {% endif %}


</body>
</html>


